<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="../styles/style.css" />
    <title>Cadastro Academia</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
      defer
    ></script>
    <script src="https://unpkg.com/lucide@latest"></script>
  </head>
  <body>
    <div class="content-wrapper">
      <div id="main-content" class="container mt-4 mb-5">
        <h1 class="mb-4">Cadastro</h1>

        <form id="student-form">
          <!-- Dados Pessoais -->
          <fieldset class="mb-4 p-3 border rounded">
            <legend class="w-auto px-2 h5">Dados Pessoais</legend>
            <div class="row g-3">
              <div class="col-md-6">
                <label for="name" class="form-label">Nome Completo</label>
                <input type="text" class="form-control" id="name" required />
              </div>
              <div class="col-md-6">
                <label for="birth" class="form-label">Data Nascimento</label>
                <input type="date" class="form-control" id="birth" required />
              </div>
              <div class="col-md-4">
                <label for="gender" class="form-label">Gênero</label>
                <select id="gender" class="form-select" required>
                  <option value="" disabled selected>Selecione...</option>
                  <option value="female">Feminino</option>
                  <option value="male">Masculino</option>
                  <option value="nonbinary">Não binário</option>
                  <option value="other">Outro</option>
                  <option value="not-informed">Prefiro não informar</option>
                </select>
              </div>
              <div class="col-md-4">
                <label for="height" class="form-label">Altura (cm)</label>
                <input
                  type="number"
                  class="form-control"
                  id="height"
                  min="100"
                  max="250"
                  required
                />
              </div>
              <div class="col-md-4">
                <label for="weight" class="form-label">Peso (kg)</label>
                <input
                  type="number"
                  class="form-control"
                  id="weight"
                  min="30"
                  max="300"
                  step="0.1"
                  required
                />
              </div>
              <div class="col-md-6">
                <label for="phone" class="form-label">Telefone</label>
                <input type="tel" class="form-control" id="phone" required />
              </div>
              <div class="col-md-6">
                <label for="email" class="form-label">Email</label>
                <input type="email" class="form-control" id="email" required />
              </div>
            </div>
          </fieldset>

          <!-- Objetivos e Treino -->
          <fieldset class="mb-4 p-3 border rounded">
            <legend class="w-auto px-2 h5">Objetivos</legend>
            <div class="row g-3">
              <div class="col-md-6">
                <label for="main-goal" class="form-label"
                  >Objetivo principal</label
                >
                <select id="main-goal" class="form-select" required>
                  <option value="" disabled selected>Selecione...</option>
                  <option value="weight-loss">Perda de peso</option>
                  <option value="muscle-gain">Ganho de massa muscular</option>
                  <option value="fitness">Condicionamento físico</option>
                  <option value="health">Saúde e bem-estar</option>
                </select>
              </div>
              <div class="col-md-6">
                <label for="frequency" class="form-label"
                  >Frequência semanal</label
                >
                <select id="frequency" class="form-select" required>
                  <option value="" disabled selected>Selecione...</option>
                  <option value="2-3">2-3 vezes</option>
                  <option value="3-4">3-4 vezes</option>
                  <option value="5+">5+ vezes</option>
                </select>
              </div>
              <div class="col-md-6">
                <label for="experience" class="form-label"
                  >Experiência prévia</label
                >
                <select id="experience" class="form-select" required>
                  <option value="" disabled selected>Selecione...</option>
                  <option value="beginner">Iniciante</option>
                  <option value="intermediate">Intermediário</option>
                  <option value="advanced">Avançado</option>
                </select>
              </div>
              <div class="col-md-6">
                <label for="training-type" class="form-label"
                  >Tipo de treino preferido</label
                >
                <select id="training-type" class="form-select" required>
                  <option value="" disabled selected>Selecione...</option>
                  <option value="strength">Musculação</option>
                  <option value="functional">Funcional</option>
                  <option value="cardio">Cardio</option>
                </select>
              </div>
            </div>
          </fieldset>

          <!-- Termos -->
          <div class="form-check mb-4">
            <input
              class="form-check-input"
              type="checkbox"
              id="terms"
              required
            />
            <label class="form-check-label" for="terms">
              Declaro que as informações são verdadeiras e estou ciente dos
              riscos da atividade física
            </label>
          </div>

          <button type="submit" class="btn btn-primary btn-lg w-100">
            <i data-lucide="save" class="me-2"></i>Salvar Cadastro
          </button>
        </form>
      </div>
    </div>

    <script>
      lucide.createIcons();

      document.addEventListener("DOMContentLoaded", function () {
        // Inicializa o Gerenciador de Layout
        new LayoutManager();

        // Manipula o Envio do Formulário
        const form = document.getElementById("student-form");
        if (form) {
          form.addEventListener("submit", function (e) {
            e.preventDefault();

            // Calcula o IMC
            const height = parseFloat(document.getElementById("height").value);
            const weight = parseFloat(document.getElementById("weight").value);
            const bmi =
              height && weight
                ? (weight / (height / 100) ** 2).toFixed(1)
                : null;

            // Prepara o objeto de dados
            const studentData = {
              personal: {
                name: document.getElementById("name").value,
                birth: document.getElementById("birth").value,
                gender: document.getElementById("gender").value,
                phone: document.getElementById("phone").value,
                email: document.getElementById("email").value,
                height: height,
                weight: weight,
                bmi: bmi,
              },
              goals: {
                main: document.getElementById("main-goal").value,
                frequency: document.getElementById("frequency").value,
                experience: document.getElementById("experience").value,
                trainingType: document.getElementById("training-type").value,
              },
              termsAccepted: document.getElementById("terms").checked,
              registrationDate: new Date().toISOString(),
            };

            // Salva no localStorage
            try {
              let gymData =
                JSON.parse(localStorage.getItem("gymStudents")) || [];
              gymData.push(studentData);
              localStorage.setItem("gymStudents", JSON.stringify(gymData));

              alert("Cadastro salvo com sucesso!");
              form.reset();
            } catch (error) {
              console.error("Erro ao salvar:", error);
              alert("Erro ao salvar cadastro. Por favor, tente novamente.");
            }
          });
        }
      });
    </script>

    <script src="../scripts/layout.js"></script>
  </body>
</html>
