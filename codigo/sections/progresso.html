<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="../styles/style.css" />
    <title>Document</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
      defer
    ></script>
    <script
      src="https://kit.fontawesome.com/64b9a24b58.js"
      crossorigin="anonymous"
    ></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="../scripts/auth.js"></script>
  </head>

  <body>
    <div class="content-wrapper">
      <aside class="sidebar">
        <div class="sidebar-header">
          <div class="logo">
            <img src="../images/logo.png" alt="GymApp Logo" class="logo-img" />
          </div>
        </div>
        <div class="sidebar-toggle" id="sidebarToggle">
          <div class="toggle-icon">
            <i class="fas fa-chevron-left"></i>
          </div>
        </div>
        <nav class="sidebar-nav">
          <!-- Header items serão populados dinamicamente pelo layout.js -->
        </nav>
        <div class="sidebar-footer"></div>
      </aside>
      <main class="main-content">
        <div class="container-fluid">
          <div class="row">
            <!-- Coluna esquerda: grande card -->
            <div class="col-lg-8 mb-4">
              <div class="card p-4 h-100">
                <!-- Resumo de progresso -->
                <div class="progresso-resumo row mb-4 g-3">
                  <div class="col-md-4">
                    <div class="card text-center h-100">
                      <div class="card-body">
                        <i class="fa-solid fa-fire fa-2x mb-2 text-warning"></i>
                        <h2 class="mb-0" id="dias-treino"></h2>
                        <p class="mb-0">dias de treino seguidos</p>
                      </div>
                    </div>
                  </div>
                  <div class="col-md-4">
                    <div class="card text-center h-100">
                      <div class="card-body">
                        <i
                          class="fa-solid fa-check fa-2x mb-2 text-success"
                        ></i>
                        <h2 class="mb-0" id="treinos-concluidos"></h2>
                        <p class="mb-0">concluídos no total</p>
                      </div>
                    </div>
                  </div>
                  <div class="col-md-4">
                    <div class="card text-center h-100">
                      <div class="card-body">
                        <i
                          class="fa-solid fa-trophy fa-2x mb-2 text-warning"
                        ></i>
                        <h2 class="mb-0" id="conquistas-atingidas"></h2>
                        <p class="mb-0">conquistas atingidas</p>
                      </div>
                    </div>
                  </div>
                </div>
                <!-- Conquistas customizadas -->
                <div class="mb-4">
                  <div
                    class="d-flex justify-content-between align-items-center mb-3"
                  >
                    <h5 class="mb-0">Suas conquistas</h5>
                    <button
                      class="btn btn-outline-primary"
                      data-bs-toggle="modal"
                      data-bs-target="#modalNovaConquista"
                    >
                      Nova conquista
                    </button>
                  </div>
                  <div class="row g-3" id="conquistas-lista">
                    <!-- Cards de conquistas serão inseridos aqui pelo JS -->
                  </div>
                </div>
                <!-- Calendário e Ranking lado a lado -->
                <div class="row g-4">
                  <div class="col-md-6">
                    <div class="card h-100">
                      <div class="card-body">
                        <div
                          class="d-flex justify-content-between align-items-center mb-2"
                        >
                          <button
                            class="btn btn-outline-secondary btn-sm"
                            id="cal-prev-mes"
                            title="Mês anterior"
                          >
                            <i class="fa fa-chevron-left"></i>
                          </button>
                          <h5 class="card-title mb-0" id="cal-mes-ano">
                            Mês Ano
                          </h5>
                          <button
                            class="btn btn-outline-secondary btn-sm"
                            id="cal-next-mes"
                            title="Próximo mês"
                          >
                            <i class="fa fa-chevron-right"></i>
                          </button>
                        </div>
                        <div class="table-responsive">
                          <table
                            class="table table-bordered text-center mb-2"
                            id="progresso-calendario"
                          >
                            <!-- Calendário será preenchido pelo JS -->
                          </table>
                        </div>
                        <div class="d-flex gap-3 align-items-center">
                          <span class="badge bg-success">Concluído</span>
                          <span class="badge bg-danger">Perdido</span>
                          <span class="badge bg-primary">Hoje</span>
                        </div>
                      </div>
                    </div>
                  </div>
                  <div class="col-md-6">
                    <div class="card h-100">
                      <div class="card-body">
                        <div
                          class="d-flex justify-content-between align-items-center mb-2"
                        >
                          <h5 class="card-title mb-0">Ranking e pontuação</h5>
                        </div>
                        <div id="progresso-ranking" class="mb-3">
                          <!-- Ranking será preenchido pelo JS -->
                        </div>
                        <div class="progress mb-2" style="height: 8px">
                          <div
                            class="progress-bar bg-primary"
                            id="ranking-progress-bar"
                            style="width: 0%"
                          ></div>
                        </div>
                        <div class="text-muted small" id="ranking-desafio">
                          Desafio do Mês: <span id="desafio-mes"></span>
                          <span class="float-end" id="desafio-status"></span>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>

                <!-- Social Features -->
                <div class="row mt-4">
                  <div class="col-12">
                    <div class="card h-100">
                      <div class="card-body">
                        <h5 class="card-title mb-3">Comunidade</h5>
                        <div class="social-features">
                          <div
                            class="d-flex justify-content-between align-items-center mb-3"
                          >
                            <div class="d-flex align-items-center gap-2">
                              <i class="fa-solid fa-users"></i>
                              <span>Grupos de Treino</span>
                            </div>
                            <button
                              class="btn btn-sm btn-outline-primary"
                              id="btn-criar-grupo"
                            >
                              Criar Grupo
                            </button>
                          </div>
                          <div class="grupos-lista mb-3" id="grupos-lista">
                            <!-- Será preenchido pelo JavaScript -->
                          </div>
                          <div class="conquistas-recentes">
                            <h6 class="mb-2">Conquistas Recentes</h6>
                            <div
                              class="recent-achievements"
                              id="recent-achievements"
                            >
                              <!-- Será preenchido pelo JavaScript -->
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <!-- Coluna direita: dicas e mobile -->
            <div class="col-lg-4">
              <div class="mb-4">
                <div
                  class="card h-100"
                  style="
                    background: #eaf6ff;
                    border: 1.5px solid #b6e0fe;
                    border-radius: 18px;
                    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.06);
                  "
                >
                  <div class="card-body">
                    <h5 class="card-title mb-3">Dicas para progredir</h5>
                    <ol
                      class="ps-3"
                      style="list-style: none; counter-reset: dica"
                    >
                      <li
                        style="
                          position: relative;
                          margin-bottom: 12px;
                          padding-left: 32px;
                        "
                      >
                        <span
                          style="
                            position: absolute;
                            left: 0;
                            top: 0;
                            width: 24px;
                            height: 24px;
                            background: #fff;
                            border: 2px solid #4fc3f7;
                            color: #2196f3;
                            border-radius: 50%;
                            display: flex;
                            align-items: center;
                            justify-content: center;
                            font-weight: 600;
                          "
                          >1</span
                        >
                        Complete treinos consecutivos para aumentar a sequência
                      </li>
                      <li
                        style="
                          position: relative;
                          margin-bottom: 12px;
                          padding-left: 32px;
                        "
                      >
                        <span
                          style="
                            position: absolute;
                            left: 0;
                            top: 0;
                            width: 24px;
                            height: 24px;
                            background: #fff;
                            border: 2px solid #4fc3f7;
                            color: #2196f3;
                            border-radius: 50%;
                            display: flex;
                            align-items: center;
                            justify-content: center;
                            font-weight: 600;
                          "
                          >2</span
                        >
                        Personalize planos de treino para ganhar mais pontos
                      </li>
                      <li
                        style="
                          position: relative;
                          margin-bottom: 12px;
                          padding-left: 32px;
                        "
                      >
                        <span
                          style="
                            position: absolute;
                            left: 0;
                            top: 0;
                            width: 24px;
                            height: 24px;
                            background: #fff;
                            border: 2px solid #4fc3f7;
                            color: #2196f3;
                            border-radius: 50%;
                            display: flex;
                            align-items: center;
                            justify-content: center;
                            font-weight: 600;
                          "
                          >3</span
                        >
                        Complete planos inteiros para desbloquear conquistas
                        especiais
                      </li>
                      <li
                        style="
                          position: relative;
                          margin-bottom: 0;
                          padding-left: 32px;
                        "
                      >
                        <span
                          style="
                            position: absolute;
                            left: 0;
                            top: 0;
                            width: 24px;
                            height: 24px;
                            background: #fff;
                            border: 2px solid #4fc3f7;
                            color: #2196f3;
                            border-radius: 50%;
                            display: flex;
                            align-items: center;
                            justify-content: center;
                            font-weight: 600;
                          "
                          >4</span
                        >
                        Tente treinos de diferentes categorias para ganhar mais
                        conquistas
                      </li>
                    </ol>
                  </div>
                </div>
              </div>
              <div>
                <div
                  class="card h-100"
                  style="
                    background: #eaf6ff;
                    border: 1.5px solid #b6e0fe;
                    border-radius: 18px;
                    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.06);
                  "
                >
                  <div
                    class="card-body d-flex flex-column align-items-center gap-3"
                  >
                    <div class="w-100">
                      <h5 class="card-title">
                        Nós também temos a versão mobile!
                      </h5>
                      <p class="mb-2" style="font-size: 0.97rem">
                        Para poder acessar dados da sua evolução, acompanhar
                        suas fichas e diversas outras funções acesse o sistema
                        diretamente do seu smartphone, mas lembrando que como os
                        dados são salvos por dispositivo, você tem que usar o
                        app
                        <b style="color: #1976d2">sempre no mesmo aparelho</b>.
                      </p>
                    </div>
                    <img
                      src="../images/cellphone.png"
                      alt="App Mobile"
                      style="
                        max-width: 90%;
                        max-height: 340px;
                        display: block;
                        margin: 32px auto 24px auto;
                      "
                    />
                  </div>
                </div>
              </div>

              <!-- Histórico de Conquistas -->
              <div class="mt-4">
                <div class="card h-100">
                  <div class="card-body">
                    <h5 class="card-title mb-3">Histórico de Conquistas</h5>
                    <div class="achievement-timeline" id="achievement-timeline">
                      <!-- Será preenchido pelo JavaScript -->
                    </div>
                  </div>
                </div>
              </div>

              <!-- Dicas Personalizadas -->
              <div class="mt-4">
                <div class="card h-100">
                  <div class="card-body">
                    <h5 class="card-title mb-3">Dicas Personalizadas</h5>
                    <div class="personalized-tips" id="personalized-tips">
                      <!-- Será preenchido pelo JavaScript -->
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </main>
    </div>

    <div
      id="toast-template"
      class="toast align-items-center border-0 text-white d-none"
      role="alert"
      aria-live="assertive"
      aria-atomic="true"
    >
      <div class="d-flex">
        <div class="toast-body">Mensagem padrão</div>
        <button
          type="button"
          class="btn-close btn-close-white me-2 m-auto"
          data-bs-dismiss="toast"
          aria-label="Close"
        ></button>
      </div>
    </div>

    <div
      id="toast-container"
      class="position-fixed top-0 end-0 p-3"
      style="z-index: 1055"
    ></div>

    <!-- Modal Nova Conquista -->
    <div
      class="modal fade"
      id="modalNovaConquista"
      tabindex="-1"
      aria-labelledby="modalNovaConquistaLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="modalNovaConquistaLabel">
              Cadastrar nova conquista
            </h5>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
              aria-label="Fechar"
            ></button>
          </div>
          <form id="form-nova-conquista">
            <div class="modal-body">
              <div class="mb-3">
                <label for="tipo-conquista" class="form-label"
                  >Tipo de conquista</label
                >
                <select class="form-select" id="tipo-conquista" required>
                  <option value="treinos">Quantidade de treinos</option>
                  <option value="streak">Dias seguidos de treino</option>
                  <option value="minutos">Minutos totais de treino</option>
                </select>
              </div>
              <div class="mb-3">
                <label for="valor-conquista" class="form-label"
                  >Valor necessário</label
                >
                <input
                  type="number"
                  class="form-control"
                  id="valor-conquista"
                  min="1"
                  required
                />
              </div>
              <div class="mb-3">
                <label class="form-label">Experiência (XP) ao resgatar</label>
                <div class="form-control bg-light" id="xp-preview" readonly>
                  0
                </div>
              </div>
              <div class="mb-3" style="display: none">
                <label for="nome-conquista" class="form-label"
                  >Nome da conquista</label
                >
                <input
                  type="text"
                  class="form-control"
                  id="nome-conquista"
                  maxlength="40"
                />
              </div>
              <div class="mb-3" style="display: none">
                <label for="descricao-conquista" class="form-label"
                  >Descrição</label
                >
                <textarea
                  class="form-control"
                  id="descricao-conquista"
                  maxlength="120"
                ></textarea>
              </div>
            </div>
            <div class="modal-footer">
              <button
                type="button"
                class="btn btn-secondary"
                data-bs-dismiss="modal"
              >
                Cancelar
              </button>
              <button type="submit" class="btn btn-primary">
                Salvar conquista
              </button>
            </div>
          </form>
        </div>
      </div>
    </div>

    <!-- Modal Treinos do Dia -->
    <div
      class="modal fade"
      id="modalTreinosDia"
      tabindex="-1"
      aria-labelledby="modalTreinosDiaLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="modalTreinosDiaLabel">
              Treinos do dia
            </h5>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
              aria-label="Fechar"
            ></button>
          </div>
          <div class="modal-body" id="treinos-dia-body">
            <!-- Conteúdo preenchido pelo JS -->
          </div>
        </div>
      </div>
    </div>

    <!-- Scripts devem estar no final do body -->
    <script src="../scripts/notifications.js" type="module"></script>
    <script src="../scripts/layout.js"></script>
    <script src="../scripts/progresso.js" type="module"></script>
  </body>
</html>

<script>
  lucide.createIcons();

  document.addEventListener("DOMContentLoaded", function () {
    const tooltipTriggerList = [].slice.call(
      document.querySelectorAll('[data-bs-toggle="tooltip"]')
    );
    tooltipTriggerList.forEach(function (tooltipTriggerEl) {
      new bootstrap.Tooltip(tooltipTriggerEl);
    });
    new LayoutManager();
  });
</script>
